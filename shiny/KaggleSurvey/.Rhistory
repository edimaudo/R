fit.rf <- train(Target~., data=df_train_new, method="rf", trControl=control)
fit.rf <- caret::train(Target~., data=df_train_new, method="rf", trControl=control)
LIBRARY(glmnet)
library(glmnet)
y <- train$target
tr <- train[,1:24]
tre <- rbind(tr,test)
tre <- tre %>%
mutate(month = as.character(month),
day = as.character(day),
ord_0 = as.character(ord_0),
bin_2 = as.character(bin_2),
bin_1 = as.character(bin_1),
bin_0 = as.character(bin_0))
tre_0 <- sparse.model.matrix(~. ,data=tre[,2:24])
tre_0 <- tre_0[,2:16530]
pf_0 <- colSums(tre_0)
tre_0<- tre_0[,pf_0>5]
tr_0 <- tre_0[1:nrow(tr),]
te_0 <- tre_0[(nrow(tr)+1):(nrow(tr)+nrow(test)),]
pf <- colSums(tr_0)
set.seed(1234)
m_cv <- cv.glmnet(tr_0,y, family = "binomial",type.measure = "auc",alpha=0,
standardize = F, lambda=seq(0.000035,0.000030,-0.0000002),
penalty.factor=(1/pf)^0.1, thresh = 1e-10, maxit = 1e9)
pr <- predict(m_cv$glmnet.fit, te_0, s= m_cv$lambda.min * 0.9,  type = "response")
colnames(pr) <- "target"
submission <- data.frame(id = tes$id, target = pr, row.names = NULL)
submission <- data.frame(id = test$id, target = pr, row.names = NULL)
write.csv(submission, file="submission_glmnet.csv", row.names = FALSE)
#remove old data
rm(list=ls())
#packages
packages <- c('ggplot2', 'corrplot','tidyverse','caret','mlbench','mice', 'caTools',
'dummies','stringr','forcats')
#load packages
for (package in packages) {
if (!require(package, character.only=T, quietly=T)) {
install.packages(package)
library(package, character.only=T)
}
}
#remove old data
rm(list=ls())
#packages
packages <- c('ggplot2', 'corrplot','tidyverse','caret','mlbench','mice',
'caTools','dummies','ggfortify)')
#load packages
for (package in packages) {
if (!require(package, character.only=T, quietly=T)) {
install.packages(package)
library(package, character.only=T)
}
}
users <- read_csv("BX-Users_clean.csv")
books <- read_csv("BX-Books_clean.csv")
ratings <- read_csv("BX-Book-Ratings_clean.csv")
setwd("~/Documents/Coding/R/shiny/bookRecommender")
#remove old data
rm(list=ls())
#packages
packages <- c('ggplot2', 'corrplot','tidyverse','caret','mlbench','mice',
'caTools','dummies','ggfortify)')
#load packages
for (package in packages) {
if (!require(package, character.only=T, quietly=T)) {
install.packages(package)
library(package, character.only=T)
}
}
users <- read_csv("BX-Users_clean.csv")
books <- read_csv("BX-Books_clean.csv")
ratings <- read_csv("BX-Book-Ratings_clean.csv")
View(books)
View(ratings)
users <- read_csv("BX-Users_clean.csv")
View(users)
View(ratings)
View(books)
install.packages("shinythemes")
shiny::runApp()
runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
shiny::runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
install.packages ("pwr")
library (pwr)
######## 2-sample test for equality of proportions ############
prop.test(c (225, 250), c (3450, 3000))
install.packages (“bayesAB”)
library (bayesAB)
######## 2-sample test for equality of proportions ############
prop.test(c (225, 250), c (3450, 3000))
A_binom <- rbinom (3450, 1, 0.065)
B_binom <- rbinom (3000, 1, 0.083)
plotBeta (1, 1)
plotBeta (100, 200) ## more specific range of p
AB1 <- bayesTest (A_binom, B_binom,
priors = c ('alpha' = 1, 'beta' = 1),
distribution = 'bernoulli')
AB2 <- bayesTest (A_binom, B_binom,
priors = c ('alpha' = 100,'beta' = 200),
distribution = 'bernoulli')
install.packages (“bayesAB”)
library (bayesAB)
uniqueTitle <- unique(books$bookTitle)
uniqueAuthor <- unique(books$bookAuthor)
uniquePublisher <- unique(books$publisher)
uniqueYear <- unique(books$yearOfPublication)
View(books)
View(ratings)
View(users)
View(books)
shiny::runApp('Documents/Coding/R/shiny/bookRecommender')
runApp('Documents/Coding/R/shiny/bookRecommender')
View(books)
View(ratings)
bookRating <- ratings %>%
inner_join(books,by = "ISBN")
View(bookRating)
bookRating <- ratings %>%
inner_join(books,by = "ISBN") %>%
select (bookTitle, bookRating)
View(bookRating)
#aggregate book ratings
bookRating2 <- bookRating %>%
group_by(bookTitle) %>%
summarise(bookRatingTotal = sum(bookRating))
View(bookRating2)
#aggregate book ratings
bookRating2 <- bookRating %>%
group_by(bookTitle) %>%
summarise(bookRatingTotal = average(bookRating))
#aggregate book ratings
bookRating2 <- bookRating %>%
group_by(bookTitle) %>%
summarise(bookRatingTotal = mean(bookRating))
View(bookRating2)
#aggregate book ratings
bookRating2 <- bookRating %>%
group_by(bookTitle) %>%
summarise(bookRatingTotal = sum(bookRating), n=n())
View(bookRating2)
bookRating2$AverageRate <- bookRating2$bookRatingTotal/bookRating2$n
View(bookRating2)
bookRating <- ratings %>%
inner_join(books,by = "ISBN") %>%
select (bookTitle, bookAuthor, bookRating)
#aggregate book ratings
bookRating2 <- bookRating %>%
group_by(bookTitle, bookAuthor) %>%
summarise(bookRatingTotal = sum(bookRating), n=n())
View(bookRating2)
bookRating2$AverageRate <- bookRating2$bookRatingTotal/bookRating2$n
View(bookRating2)
#top 5 book ratings visualization
p<-ggplot(data=bookRating2, aes(x=bookAuthor, y=AverageRate)) +
geom_bar(stat="identity")
# Horizontal bar plot
p + coord_flip()
bookRatingTop5 <- bookRating2 %>% top_n(5)
#top 5 book ratings visualization
p<-ggplot(data=bookRatingTop5, aes(x=bookAuthor, y=AverageRate)) +
geom_bar(stat="identity")
# Horizontal bar plot
p + coord_flip()
View(bookRatingTop5)
View(bookRating2)
bookRatingTop5 <- bookRating2 %>%
select(bookTitle, bookAuthor, AverageRate) %>%
tally(AverageRate) %>%
top_n(5)
View(bookRatingTop5)
bookRatingTop5 <- bookRating2 %>%
select(bookTitle, bookAuthor, AverageRate) %>%
arrange(desc(AverageRate)) %>%
top_n(5)
View(bookRatingTop5)
bookRatingTop5 %>% top_n(5)
bookRatingTop5 <- bookRatingTop5 %>% top_n(5)
bookRatingTop5 <- bookRating2 %>%
arrange(desc(AverageRate)) %>%
select(bookTitle, bookAuthor, AverageRate) %>%
top_n(5)
bookRatingTop5 <- bookRating2 %>%
arrange(desc(AverageRate)) %>%
top_n(5) %>%
select(bookTitle, bookAuthor, AverageRate)
bookRatingTop5 <- bookRating2 %>%
arrange(desc(AverageRate)) %>%
head(n = 10L) %>%
select(bookTitle, bookAuthor, AverageRate)
View(bookRatingTop5)
#top 5 book ratings visualization
p<-ggplot(data=bookRatingTop, aes(x=bookTitle, y=AverageRate)) +
geom_bar(stat="identity")
# Horizontal bar plot
p + coord_flip()
bookRatingTop <- bookRating2 %>%
arrange(desc(AverageRate)) %>%
head(n = 10L) %>%
select(bookTitle, bookAuthor, AverageRate) %>%
#top 5 book ratings visualization
p<-ggplot(data=bookRatingTop, aes(x=bookTitle, y=AverageRate)) +
geom_bar(stat="identity")
# Horizontal bar plot
p + coord_flip()
bookRatingTop <- bookRating2 %>%
arrange(desc(AverageRate)) %>%
head(n = 10L) %>%
select(bookTitle, bookAuthor, AverageRate)
#top 5 book ratings visualization
p<-ggplot(data=bookRatingTop, aes(x=bookTitle, y=AverageRate)) +
geom_bar(stat="identity")
# Horizontal bar plot
p + coord_flip()
bookPublishing <- books %>%
select (bookAuthor, yearOfPublication) %>%
group_by(yearOfPublication) %>%
tally()
View(bookPublishing)
bookPublishing <- books %>%
select (bookAuthor, yearOfPublication) %>%
group_by(bookAuthor,yearOfPublication) %>%
tally() %>%
arrange(desc(n)) %>%
head(n = 10L)
View(bookPublishing)
p<-ggplot(data=bookPublishing, aes(x=yearOfPublication, y=n)) +
geom_bar(stat="identity")
p
View(users)
View(ratings)
bookAge <- ratings %>%
inner_join(books, by="ISBN") %>%
inner_join(users, by="userID") %>%
select(bookAuthor, Age)
View(bookAge)
# Basic histogram
ggplot(bookAge, aes(x=Age)) + geom_histogram()
# Change the width of bins
# Basic histogram
ggplot(bookAge, aes(x=Age)) + geom_histogram()
# Change the width of bins
ggplot(df, aes(x=weight)) +
geom_histogram(binwidth=1)
# Change the width of bins
ggplot(bookAge, aes(x=Age)) +
geom_histogram(binwidth=1)
# Basic histogram
ggplot(bookAge, aes(x=Age)) + geom_histogram()
# Change the width of bins
ggplot(bookAge, aes(x=Age)) +
geom_histogram(binwidth=10)
ggplot(bookAge, aes(x=Age)) +
geom_histogram(binwidth=25)
bookLocation <- ratings %>%
inner_join(books, by="ISBN") %>%
inner_join(users, by="userID") %>%
select(bookAuthor, Location)
View(bookLocation)
bookLocation2 <- separate(bookLocation, Location,
into = c("area", "location","country"), sep = 3)
bookLocation2 <- separate(bookLocation, Location,
into = c("area", "location","country"), sep = 2)
bookLocation2 <- separate(bookLocation, Location,
into = c("area", "location","country"), sep = ",")
View(bookLocation2)
View(bookLocation2)
bookLocation3 <- bookLocation2 %>%
group_by(bookAuthor, country) %>%
tally()
View(bookLocation3)
shiny::runApp('Documents/Coding/R/shiny/KaggleSurvey')
shiny::runApp('Documents/Coding/R/shiny/KaggleSurvey')
#
# This is a Shiny web application that uses the Kaggle 2019 Data
# Science and Machine learning survery
#
#remove old data
#rm(list=ls())
#packages
packages <- c('ggplot2', 'corrplot','tidyverse','caret','mlbench','mice',
'caTools','dummies','ggfortify','shiny')
#load packages
for (package in packages) {
if (!require(package, character.only=T, quietly=T)) {
install.packages(package)
library(package, character.only=T)
}
}
#load data
multipleChoice <- read_csv("multiple_choice_responses.csv")
otherText <- read_csv("other_text_responses.csv")
questions <- read_csv("questions_only.csv")
surveySchema<- read_csv("survey_schema.csv")
setwd("~/Documents/Coding/R/shiny/KaggleSurvey")
#
# This is a Shiny web application that uses the Kaggle 2019 Data
# Science and Machine learning survery
#
#remove old data
#rm(list=ls())
#packages
packages <- c('ggplot2', 'corrplot','tidyverse','caret','mlbench','mice',
'caTools','dummies','ggfortify','shiny','countrycode','highcharter',"tidyr")
#load packages
for (package in packages) {
if (!require(package, character.only=T, quietly=T)) {
install.packages(package)
library(package, character.only=T)
}
}
#load data
multipleChoice <- read_csv("multiple_choice_responses.csv")
#otherText <- read_csv("other_text_responses.csv")
#questions <- read_csv("questions_only.csv")
#surveySchema<- read_csv("survey_schema.csv")
responses <- multipleChoice %>%
slice(2:n()) %>%
rename("duration" = `Time from Start to Finish (seconds)`) %>%
mutate(Q3 = str_replace_all(Q3,
c("United Kingdom of Great Britain and Northern Ireland" = "UK" ,
"United States of America" = "USA",
"Hong Kong \\(S\\.A\\.R\\.\\)" = "Hong Kong",
"Iran, Islamic Republic of..." = "Iran")))
gendercountryinfo <- responses %>%
select(Q2) %>%
filter(Q2 in 'Iran','USA') %>%
group_by(Q2) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
select(Q2,Q3) %>%
filter(Q3 in 'Iran','USA') %>%
group_by(Q2) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
select(Q2,Q3) %>%
filter(Q3 in 'Iran','USA') %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
View(responses)
gendercountryinfo <- responses %>%
select(Q2,Q3) %>%
filter(Q3 in 'Iran','USA') %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
filter(Q3 in 'Iran','USA') %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
filter(Q3 in 'Iran','USA')
gendercountryinfo <- responses %>%
filter(Q3 in c('Iran','USA'))
gendercountryinfo <- responses %>%
filter(Q3 == 'Iran')
gendercountryinfo <- responses %>%
filter(Q3 == 'Iran') %>%
group_by(Q2,Q3)
gendercountryinfo <- responses %>%
filter(Q3 == 'Iran') %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
filter(Q3 == 'Iran' ,Q3 == "USA") %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
gendercountryinfo <- responses %>%
filter(Q3  %in% c("Iran", "USA")) %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
View(gendercountryinfo)
genderplot <- gendercountryinfo <- responses %>%
filter(Q3  %in% c("Iran")) %>%
group_by(Q2) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
genderplot1 <- gendercountryinfo <- responses %>%
filter(Q3  %in% c("USA")) %>%
group_by(Q2) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
View(gendercountryinfo)
View(genderplot)
g1 <- ggplot(data=genderplot1, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
g2 <- ggplot(data=genderplot2, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
library(gridExtra)
grid.arrange(g1,g2, ncol=2)
g1 <- ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
g2 <- ggplot(data=genderplot1, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
library(gridExtra)
grid.arrange(g1,g2, ncol=2)
g1 <- ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 15),
axis.text = element_text(size = 5)) + coord_flip()
g2 <- ggplot(data=genderplot1, aes(x=reorder(Q2,-freq), y=freq)) +
geom_bar(stat="identity",fill="steelblue") + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 15),
axis.text = element_text(size = 5)) + coord_flip()
library(gridExtra)
grid.arrange(g1,g2, ncol=2)
genderplot <- gendercountryinfo <- responses %>%
filter(Q3  %in% c("Iran",'USA')) %>%
group_by(Q2,Q3) %>%
summarize(freq = n()) %>%
arrange(desc(freq))
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.text.x = element_text(angle = 0, hjust = 1),
legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(legend.position="none",axis.title = element_text(size = 25),
axis.text = element_text(size = 15)) + coord_flip()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count",
lengend = "COuntry") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(legend.title = "Country",axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge()) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country")
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.1) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country")
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 1.5) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country")
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.5) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country")
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.9) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country")
runApp()
runApp()
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.9) + theme_classic() + labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country") + scale_X_continuous(breaks = c(0,200,400,600,800,1000,1200,1400,
1600,1800,2000,2200,2400,2600))
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.9) + theme_classic() +
labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
labs(fill = "Country") + scale_Y_continuous(breaks = c(0,200,400,600,800,1000,1200,1400,
1600,1800,2000,2200,2400,2600))
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.9) + theme_classic() +
labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
labs(fill = "Country") + scale_y_continuous(breaks = c(0,200,400,600,800,1000,1200,1400,
1600,1800,2000,2200,2400,2600))
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.7) + theme_classic() +
labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
coord_flip() + labs(fill = "Country") + scale_x_continuous(breaks = c(0,200,400,600,800,1000,1200,1400,
1600,1800,2000,2200,2400,2600))
ggplot(data=genderplot, aes(x=reorder(Q2,-freq), y=freq, fill=Q3)) +
geom_bar(stat="identity",position=position_dodge(),width = 0.7) + theme_classic() +
labs(x = "Gender", y = "Count") +
theme(axis.title = element_text(size = 25),axis.text = element_text(size = 15)) +
labs(fill = "Country") + scale_y_continuous(breaks = c(0,200,400,600,800,1000,1200,1400,
1600,1800,2000,2200,2400,2600))
runApp()
